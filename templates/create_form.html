<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#cc5500">
    <title>Create Form - Barmuda</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Phosphor Icons -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    
    <!-- Custom Tailwind Config -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'bermuda-orange': '#cc5500',
                        'bermuda-red': '#d12b2e',
                        'bermuda-cream': '#fff5e0',
                        'bermuda-light-cream': '#fffcf4',
                        'bermuda-border': '#fb9a9a',
                        'bermuda-nav-border': '#fff0cf',
                        'bermuda-text': '#1e1e1e',
                        'bermuda-gray': '#c3c3c3'
                    },
                    fontFamily: {
                        'jakarta': ['Plus Jakarta Sans', 'sans-serif'],
                        'dm': ['DM Sans', 'sans-serif']
                    }
                }
            }
        }
    </script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&family=DM+Sans:opsz,wght@9..40,400;9..40,500;9..40,600;9..40,700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.0.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.0.0/firebase-analytics-compat.js"></script>
</head>
<body class="bg-[#fff5e0] relative min-h-screen font-['DM_Sans']">

    <!-- Main Container -->
    <div class="relative z-10 min-h-screen flex flex-col">
        {% set nav_type = 'create_form' %}
        {% include 'partials/nav.html' %}

        <!-- Main Content Area -->
        <div class="flex-1 flex flex-col items-center px-4 md:px-8 space-y-6 md:space-y-10 pt-32 md:pt-40 pb-16 md:pb-24">
            <!-- Main Heading -->
            <div class="text-center max-w-4xl space-y-4">
                <h1 class="font-['Plus_Jakarta_Sans'] font-bold text-3xl md:text-4xl lg:text-5xl text-[#1e1e1e] tracking-[-0.02em] leading-[1.15]">
                    People hate filling out forms.
                </h1>
                <h2 class="font-['Plus_Jakarta_Sans'] font-semibold text-2xl md:text-3xl lg:text-4xl text-[#cc5500] tracking-[-0.02em] leading-[1.2]">
                    Infinite user interviewers. One prompt away.
                </h2>
                <p class="font-['DM_Sans'] text-base md:text-lg lg:text-xl text-[#6b7280] max-w-3xl mx-auto leading-relaxed">
                    Paste your questions, get a link. People chat with AI instead of filling boring forms.
                </p>
            </div>
            
            <!-- Form Input Area -->
            <div class="w-full max-w-3xl relative">
                <div id="inputCard" class="bg-[#fffcf4] border border-[#fb9a9a] rounded-2xl relative transition-all duration-300 hover:border-[#cc5500]/80">
                    <textarea 
                        id="formDump"
                        placeholder="Describe what kind of survey you want to create..."
                        class="w-full h-36 md:h-46 p-4 md:p-6 bg-transparent border-none outline-none resize-none font-['DM_Sans'] text-base md:text-lg text-[#1e1e1e] placeholder-[#9ca3af] leading-relaxed"
                        oninput="validateInput()"
                    ></textarea>
                    
                    <!-- Generate Button (Inside the box) -->
                    <button 
                        id="generateBtn"
                        onclick="generateForm()"
                        class="absolute bottom-4 right-4 bg-gradient-to-r from-[#cc5500] to-[#d12b2e] rounded-xl px-4 py-2.5 text-white font-['Plus_Jakarta_Sans'] font-medium text-sm transition-all duration-200 flex items-center gap-2 hover:scale-105 disabled:opacity-60 disabled:cursor-not-allowed"
                        disabled
                    >
                        <span id="buttonText">Generate</span>
                        <div id="buttonSpinner" class="hidden">
                            <div class="flex space-x-1">
                                <div class="w-1.5 h-1.5 bg-white rounded-full animate-bounce" style="animation-delay: 0ms;"></div>
                                <div class="w-1.5 h-1.5 bg-white rounded-full animate-bounce" style="animation-delay: 150ms;"></div>
                                <div class="w-1.5 h-1.5 bg-white rounded-full animate-bounce" style="animation-delay: 300ms;"></div>
                            </div>
                        </div>
                        <i class="ph ph-arrow-right text-sm"></i>
                    </button>
                </div>
                
                <!-- Validation Message (Outside the box) -->
                <div id="validationMessage" class="hidden mt-2 text-sm text-red-600 font-['DM_Sans']"></div>
            </div>
            
            <!-- Error State -->
            <div id="errorState" class="hidden w-full max-w-2xl">
                <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                    <p class="text-red-800 font-['DM_Sans']">
                        <span class="font-semibold">Error:</span>
                        <span id="errorMessage"></span>
                    </p>
                    <button onclick="document.getElementById('errorState').classList.add('hidden')" 
                            class="mt-2 text-red-600 hover:text-red-800 font-['DM_Sans'] text-sm">
                        Dismiss
                    </button>
                </div>
            </div>
            
            <!-- User Interview Templates Carousel -->
            <div class="w-full max-w-6xl">
                <div class="text-center mb-6">
                    <p class="font-['DM_Sans'] text-xs md:text-sm text-[#6b7280] font-medium uppercase tracking-wider">User Interview Templates</p>
                </div>
                
                <!-- Carousel Container -->
                <div class="relative">
                    
                    <!-- Carousel Content -->
                    <div id="carousel-container" class="overflow-hidden">
                        <div id="carousel-track" class="flex transition-transform duration-500 ease-out">
                            
                            <!-- Page 1 - Core User Research (12 templates) -->
                            <div class="flex-shrink-0 w-full">
                                <div class="flex flex-wrap gap-2 justify-center max-w-5xl mx-auto">
                            
                            <!-- User Interview -->
                            <div class="bg-white border border-[#DAB568] rounded-full px-2 md:px-3 py-1.5 md:py-2 hover:bg-[#cc5500] hover:border-[#cc5500] hover:text-white transition-all duration-200 cursor-pointer group" onclick="useTemplate('user-interview')">
                                <div class="flex items-center gap-1.5">
                                    <i class="ph ph-user-focus text-[#cc5500] group-hover:text-white text-sm transition-colors"></i>
                                    <h3 class="font-['Plus_Jakarta_Sans'] font-medium text-xs text-[#8B4513] group-hover:text-white transition-colors whitespace-nowrap">
                                        User Interview
                                    </h3>
                                </div>
                            </div>

                            <!-- Product Discovery -->
                            <div class="bg-white border border-[#DAB568] rounded-full px-2 md:px-3 py-1.5 md:py-2 hover:bg-[#cc5500] hover:border-[#cc5500] hover:text-white transition-all duration-200 cursor-pointer group" onclick="useTemplate('product-discovery')">
                                <div class="flex items-center gap-1.5">
                                    <i class="ph ph-lightbulb text-[#cc5500] group-hover:text-white text-sm transition-colors"></i>
                                    <h3 class="font-['Plus_Jakarta_Sans'] font-medium text-xs text-[#8B4513] group-hover:text-white transition-colors whitespace-nowrap">
                                        Product Discovery
                                    </h3>
                                </div>
                            </div>

                            <!-- Customer Journey -->
                            <div class="bg-white border border-[#DAB568] rounded-full px-2 md:px-3 py-1.5 md:py-2 hover:bg-[#cc5500] hover:border-[#cc5500] hover:text-white transition-all duration-200 cursor-pointer group" onclick="useTemplate('customer-journey')">
                                <div class="flex items-center gap-1.5">
                                    <i class="ph ph-map-trifold text-[#cc5500] group-hover:text-white text-sm transition-colors"></i>
                                    <h3 class="font-['Plus_Jakarta_Sans'] font-medium text-xs text-[#8B4513] group-hover:text-white transition-colors whitespace-nowrap">
                                        Customer Journey
                                    </h3>
                                </div>
                            </div>

                            <!-- Pain Point Analysis -->
                            <div class="bg-white border border-[#DAB568] rounded-full px-2 md:px-3 py-1.5 md:py-2 hover:bg-[#cc5500] hover:border-[#cc5500] hover:text-white transition-all duration-200 cursor-pointer group" onclick="useTemplate('pain-point-analysis')">
                                <div class="flex items-center gap-1.5">
                                    <i class="ph ph-warning-diamond text-[#cc5500] group-hover:text-white text-sm transition-colors"></i>
                                    <h3 class="font-['Plus_Jakarta_Sans'] font-medium text-xs text-[#8B4513] group-hover:text-white transition-colors whitespace-nowrap">
                                        Pain Points
                                    </h3>
                                </div>
                            </div>

                            <!-- Feature Validation -->
                            <div class="bg-white border border-[#DAB568] rounded-full px-2 md:px-3 py-1.5 md:py-2 hover:bg-[#cc5500] hover:border-[#cc5500] hover:text-white transition-all duration-200 cursor-pointer group" onclick="useTemplate('feature-validation')">
                                <div class="flex items-center gap-1.5">
                                    <i class="ph ph-check-square text-[#cc5500] group-hover:text-white text-sm transition-colors"></i>
                                    <h3 class="font-['Plus_Jakarta_Sans'] font-medium text-xs text-[#8B4513] group-hover:text-white transition-colors whitespace-nowrap">
                                        Feature Validation
                                    </h3>
                                </div>
                            </div>

                            <!-- Usability Testing -->
                            <div class="bg-white border border-[#DAB568] rounded-full px-2 md:px-3 py-1.5 md:py-2 hover:bg-[#cc5500] hover:border-[#cc5500] hover:text-white transition-all duration-200 cursor-pointer group" onclick="useTemplate('usability-testing')">
                                <div class="flex items-center gap-1.5">
                                    <i class="ph ph-cursor-click text-[#cc5500] group-hover:text-white text-sm transition-colors"></i>
                                    <h3 class="font-['Plus_Jakarta_Sans'] font-medium text-xs text-[#8B4513] group-hover:text-white transition-colors whitespace-nowrap">
                                        Usability Testing
                                    </h3>
                                </div>
                            </div>
                            
                            <!-- Persona Research -->
                            <div class="bg-white border border-[#DAB568] rounded-full px-2 md:px-3 py-1.5 md:py-2 hover:bg-[#cc5500] hover:border-[#cc5500] hover:text-white transition-all duration-200 cursor-pointer group" onclick="useTemplate('persona-research')">
                                <div class="flex items-center gap-1.5">
                                    <i class="ph ph-users text-[#cc5500] group-hover:text-white text-sm transition-colors"></i>
                                    <h3 class="font-['Plus_Jakarta_Sans'] font-medium text-xs text-[#8B4513] group-hover:text-white transition-colors whitespace-nowrap">
                                        Persona Research
                                    </h3>
                                </div>
                            </div>
                            
                            <!-- Jobs to be Done -->
                            <div class="bg-white border border-[#DAB568] rounded-full px-2 md:px-3 py-1.5 md:py-2 hover:bg-[#cc5500] hover:border-[#cc5500] hover:text-white transition-all duration-200 cursor-pointer group" onclick="useTemplate('jobs-to-be-done')">
                                <div class="flex items-center gap-1.5">
                                    <i class="ph ph-briefcase text-[#cc5500] group-hover:text-white text-sm transition-colors"></i>
                                    <h3 class="font-['Plus_Jakarta_Sans'] font-medium text-xs text-[#8B4513] group-hover:text-white transition-colors whitespace-nowrap">
                                        Jobs to be Done
                                    </h3>
                                </div>
                            </div>
                            
                            <!-- Product Market Fit -->
                            <div class="bg-white border border-[#DAB568] rounded-full px-2 md:px-3 py-1.5 md:py-2 hover:bg-[#cc5500] hover:border-[#cc5500] hover:text-white transition-all duration-200 cursor-pointer group" onclick="useTemplate('product-market-fit')">
                                <div class="flex items-center gap-1.5">
                                    <i class="ph ph-target text-[#cc5500] group-hover:text-white text-sm transition-colors"></i>
                                    <h3 class="font-['Plus_Jakarta_Sans'] font-medium text-xs text-[#8B4513] group-hover:text-white transition-colors whitespace-nowrap">
                                        Market Fit
                                    </h3>
                                </div>
                            </div>
                            
                            <!-- Competitor Analysis -->
                            <div class="bg-white border border-[#DAB568] rounded-full px-2 md:px-3 py-1.5 md:py-2 hover:bg-[#cc5500] hover:border-[#cc5500] hover:text-white transition-all duration-200 cursor-pointer group" onclick="useTemplate('competitor-analysis')">
                                <div class="flex items-center gap-1.5">
                                    <i class="ph ph-sword text-[#cc5500] group-hover:text-white text-sm transition-colors"></i>
                                    <h3 class="font-['Plus_Jakarta_Sans'] font-medium text-xs text-[#8B4513] group-hover:text-white transition-colors whitespace-nowrap">
                                        Competitor Analysis
                                    </h3>
                                </div>
                            </div>
                            
                            <!-- Pricing Validation -->
                            <div class="bg-white border border-[#DAB568] rounded-full px-2 md:px-3 py-1.5 md:py-2 hover:bg-[#cc5500] hover:border-[#cc5500] hover:text-white transition-all duration-200 cursor-pointer group" onclick="useTemplate('pricing-validation')">
                                <div class="flex items-center gap-1.5">
                                    <i class="ph ph-currency-dollar text-[#cc5500] group-hover:text-white text-sm transition-colors"></i>
                                    <h3 class="font-['Plus_Jakarta_Sans'] font-medium text-xs text-[#8B4513] group-hover:text-white transition-colors whitespace-nowrap">
                                        Pricing Validation
                                    </h3>
                                </div>
                            </div>
                            
                                </div>
                            </div>
                            
                            <!-- Page 2 - Customer Success & Retention (12 templates) -->
                            <div class="flex-shrink-0 w-full">
                                <div class="flex flex-wrap gap-2 justify-center max-w-5xl mx-auto">
                                    
                                    <!-- Market Segmentation -->
                                    <div class="bg-white border border-[#DAB568] rounded-full px-2 md:px-3 py-1.5 md:py-2 hover:bg-[#cc5500] hover:border-[#cc5500] hover:text-white transition-all duration-200 cursor-pointer group" onclick="useTemplate('market-segmentation')">
                                        <div class="flex items-center gap-1.5">
                                            <i class="ph ph-chart-pie text-[#cc5500] group-hover:text-white text-sm transition-colors"></i>
                                            <h3 class="font-['Plus_Jakarta_Sans'] font-medium text-xs text-[#8B4513] group-hover:text-white transition-colors whitespace-nowrap">
                                                Market Segmentation
                                            </h3>
                                        </div>
                                    </div>
                                    
                                    <!-- Onboarding Research -->
                                    <div class="bg-white border border-[#DAB568] rounded-full px-2 md:px-3 py-1.5 md:py-2 hover:bg-[#cc5500] hover:border-[#cc5500] hover:text-white transition-all duration-200 cursor-pointer group" onclick="useTemplate('onboarding-research')">
                                        <div class="flex items-center gap-1.5">
                                            <i class="ph ph-rocket text-[#cc5500] group-hover:text-white text-sm transition-colors"></i>
                                            <h3 class="font-['Plus_Jakarta_Sans'] font-medium text-xs text-[#8B4513] group-hover:text-white transition-colors whitespace-nowrap">
                                                Onboarding Research
                                            </h3>
                                        </div>
                                    </div>
                                    
                                    <!-- Churn Prevention -->
                                    <div class="bg-white border border-[#DAB568] rounded-full px-2 md:px-3 py-1.5 md:py-2 hover:bg-[#cc5500] hover:border-[#cc5500] hover:text-white transition-all duration-200 cursor-pointer group" onclick="useTemplate('churn-prevention')">
                                        <div class="flex items-center gap-1.5">
                                            <i class="ph ph-shield text-[#cc5500] group-hover:text-white text-sm transition-colors"></i>
                                            <h3 class="font-['Plus_Jakarta_Sans'] font-medium text-xs text-[#8B4513] group-hover:text-white transition-colors whitespace-nowrap">
                                                Churn Prevention
                                            </h3>
                                        </div>
                                    </div>
                                    
                                    <!-- Expansion Research -->
                                    <div class="bg-white border border-[#DAB568] rounded-full px-2 md:px-3 py-1.5 md:py-2 hover:bg-[#cc5500] hover:border-[#cc5500] hover:text-white transition-all duration-200 cursor-pointer group" onclick="useTemplate('expansion-research')">
                                        <div class="flex items-center gap-1.5">
                                            <i class="ph ph-arrow-up-right text-[#cc5500] group-hover:text-white text-sm transition-colors"></i>
                                            <h3 class="font-['Plus_Jakarta_Sans'] font-medium text-xs text-[#8B4513] group-hover:text-white transition-colors whitespace-nowrap">
                                                Expansion Research
                                            </h3>
                                        </div>
                                    </div>
                                    
                                    <!-- NPS Deep Dive -->
                                    <div class="bg-white border border-[#DAB568] rounded-full px-2 md:px-3 py-1.5 md:py-2 hover:bg-[#cc5500] hover:border-[#cc5500] hover:text-white transition-all duration-200 cursor-pointer group" onclick="useTemplate('nps-deep-dive')">
                                        <div class="flex items-center gap-1.5">
                                            <i class="ph ph-gauge text-[#cc5500] group-hover:text-white text-sm transition-colors"></i>
                                            <h3 class="font-['Plus_Jakarta_Sans'] font-medium text-xs text-[#8B4513] group-hover:text-white transition-colors whitespace-nowrap">
                                                NPS Deep Dive
                                            </h3>
                                        </div>
                                    </div>
                                    
                                    <!-- Roadmap Priority -->
                                    <div class="bg-white border border-[#DAB568] rounded-full px-2 md:px-3 py-1.5 md:py-2 hover:bg-[#cc5500] hover:border-[#cc5500] hover:text-white transition-all duration-200 cursor-pointer group" onclick="useTemplate('roadmap-prioritization')">
                                        <div class="flex items-center gap-1.5">
                                            <i class="ph ph-road-horizon text-[#cc5500] group-hover:text-white text-sm transition-colors"></i>
                                            <h3 class="font-['Plus_Jakarta_Sans'] font-medium text-xs text-[#8B4513] group-hover:text-white transition-colors whitespace-nowrap">
                                                Roadmap Priority
                                            </h3>
                                        </div>
                                    </div>
                                    
                                    <!-- Brand Perception -->
                                    <div class="bg-white border border-[#DAB568] rounded-full px-2 md:px-3 py-1.5 md:py-2 hover:bg-[#cc5500] hover:border-[#cc5500] hover:text-white transition-all duration-200 cursor-pointer group" onclick="useTemplate('brand-perception')">
                                        <div class="flex items-center gap-1.5">
                                            <i class="ph ph-megaphone text-[#cc5500] group-hover:text-white text-sm transition-colors"></i>
                                            <h3 class="font-['Plus_Jakarta_Sans'] font-medium text-xs text-[#8B4513] group-hover:text-white transition-colors whitespace-nowrap">
                                                Brand Perception
                                            </h3>
                                        </div>
                                    </div>
                                    
                                    <!-- User Behavior -->
                                    <div class="bg-white border border-[#DAB568] rounded-full px-2 md:px-3 py-1.5 md:py-2 hover:bg-[#cc5500] hover:border-[#cc5500] hover:text-white transition-all duration-200 cursor-pointer group" onclick="useTemplate('user-behavior')">
                                        <div class="flex items-center gap-1.5">
                                            <i class="ph ph-user-list text-[#cc5500] group-hover:text-white text-sm transition-colors"></i>
                                            <h3 class="font-['Plus_Jakarta_Sans'] font-medium text-xs text-[#8B4513] group-hover:text-white transition-colors whitespace-nowrap">
                                                User Behavior
                                            </h3>
                                        </div>
                                    </div>
                                    
                                    <!-- Retention Drivers -->
                                    <div class="bg-white border border-[#DAB568] rounded-full px-2 md:px-3 py-1.5 md:py-2 hover:bg-[#cc5500] hover:border-[#cc5500] hover:text-white transition-all duration-200 cursor-pointer group" onclick="useTemplate('retention-drivers')">
                                        <div class="flex items-center gap-1.5">
                                            <i class="ph ph-heart text-[#cc5500] group-hover:text-white text-sm transition-colors"></i>
                                            <h3 class="font-['Plus_Jakarta_Sans'] font-medium text-xs text-[#8B4513] group-hover:text-white transition-colors whitespace-nowrap">
                                                Retention Drivers
                                            </h3>
                                        </div>
                                    </div>
                                    
                                    <!-- B2B Buying Process -->
                                    <div class="bg-white border border-[#DAB568] rounded-full px-2 md:px-3 py-1.5 md:py-2 hover:bg-[#cc5500] hover:border-[#cc5500] hover:text-white transition-all duration-200 cursor-pointer group" onclick="useTemplate('b2b-buying-process')">
                                        <div class="flex items-center gap-1.5">
                                            <i class="ph ph-handshake text-[#cc5500] group-hover:text-white text-sm transition-colors"></i>
                                            <h3 class="font-['Plus_Jakarta_Sans'] font-medium text-xs text-[#8B4513] group-hover:text-white transition-colors whitespace-nowrap">
                                                B2B Buying Process
                                            </h3>
                                        </div>
                                    </div>
                                    
                                    <!-- Mobile Usage -->
                                    <div class="bg-white border border-[#DAB568] rounded-full px-2 md:px-3 py-1.5 md:py-2 hover:bg-[#cc5500] hover:border-[#cc5500] hover:text-white transition-all duration-200 cursor-pointer group" onclick="useTemplate('mobile-usage')">
                                        <div class="flex items-center gap-1.5">
                                            <i class="ph ph-device-mobile text-[#cc5500] group-hover:text-white text-sm transition-colors"></i>
                                            <h3 class="font-['Plus_Jakarta_Sans'] font-medium text-xs text-[#8B4513] group-hover:text-white transition-colors whitespace-nowrap">
                                                Mobile Usage
                                            </h3>
                                        </div>
                                    </div>
                                    
                                    <!-- Integration Research -->
                                    <div class="bg-white border border-[#DAB568] rounded-full px-2 md:px-3 py-1.5 md:py-2 hover:bg-[#cc5500] hover:border-[#cc5500] hover:text-white transition-all duration-200 cursor-pointer group" onclick="useTemplate('integration-research')">
                                        <div class="flex items-center gap-1.5">
                                            <i class="ph ph-plugs text-[#cc5500] group-hover:text-white text-sm transition-colors"></i>
                                            <h3 class="font-['Plus_Jakarta_Sans'] font-medium text-xs text-[#8B4513] group-hover:text-white transition-colors whitespace-nowrap">
                                                Integration Research
                                            </h3>
                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                            
                            <!-- Page 3 - Specialized Research (12 templates) -->
                            <div class="flex-shrink-0 w-full">
                                <div class="flex flex-wrap gap-2 justify-center max-w-5xl mx-auto">
                                    
                                    <!-- Accessibility Research -->
                                    <div class="bg-white border border-[#DAB568] rounded-full px-2 md:px-3 py-1.5 md:py-2 hover:bg-[#cc5500] hover:border-[#cc5500] hover:text-white transition-all duration-200 cursor-pointer group" onclick="useTemplate('accessibility-research')">
                                        <div class="flex items-center gap-1.5">
                                            <i class="ph ph-accessibility text-[#cc5500] group-hover:text-white text-sm transition-colors"></i>
                                            <h3 class="font-['Plus_Jakarta_Sans'] font-medium text-xs text-[#8B4513] group-hover:text-white transition-colors whitespace-nowrap">
                                                Accessibility Research
                                            </h3>
                                        </div>
                                    </div>
                                    
                                    <!-- Customer Feedback -->
                                    <div class="bg-white border border-[#DAB568] rounded-full px-2 md:px-3 py-1.5 md:py-2 hover:bg-[#cc5500] hover:border-[#cc5500] hover:text-white transition-all duration-200 cursor-pointer group" onclick="useTemplate('customer-feedback')">
                                        <div class="flex items-center gap-1.5">
                                            <i class="ph ph-chat-circle-dots text-[#cc5500] group-hover:text-white text-sm transition-colors"></i>
                                            <h3 class="font-['Plus_Jakarta_Sans'] font-medium text-xs text-[#8B4513] group-hover:text-white transition-colors whitespace-nowrap">
                                                Customer Feedback
                                            </h3>
                                        </div>
                                    </div>
                                    
                                    <!-- Employee Survey -->
                                    <div class="bg-white border border-[#DAB568] rounded-full px-2 md:px-3 py-1.5 md:py-2 hover:bg-[#cc5500] hover:border-[#cc5500] hover:text-white transition-all duration-200 cursor-pointer group" onclick="useTemplate('employee-survey')">
                                        <div class="flex items-center gap-1.5">
                                            <i class="ph ph-users text-[#cc5500] group-hover:text-white text-sm transition-colors"></i>
                                            <h3 class="font-['Plus_Jakarta_Sans'] font-medium text-xs text-[#8B4513] group-hover:text-white transition-colors whitespace-nowrap">
                                                Employee Survey
                                            </h3>
                                        </div>
                                    </div>
                                    
                                    <!-- Patient Experience -->
                                    <div class="bg-white border border-[#DAB568] rounded-full px-2 md:px-3 py-1.5 md:py-2 hover:bg-[#cc5500] hover:border-[#cc5500] hover:text-white transition-all duration-200 cursor-pointer group" onclick="useTemplate('patient-satisfaction')">
                                        <div class="flex items-center gap-1.5">
                                            <i class="ph ph-heart text-[#cc5500] group-hover:text-white text-sm transition-colors"></i>
                                            <h3 class="font-['Plus_Jakarta_Sans'] font-medium text-xs text-[#8B4513] group-hover:text-white transition-colors whitespace-nowrap">
                                                Patient Experience
                                            </h3>
                                        </div>
                                    </div>
                                    
                                    <!-- Course Evaluation -->
                                    <div class="bg-white border border-[#DAB568] rounded-full px-2 md:px-3 py-1.5 md:py-2 hover:bg-[#cc5500] hover:border-[#cc5500] hover:text-white transition-all duration-200 cursor-pointer group" onclick="useTemplate('course-evaluation')">
                                        <div class="flex items-center gap-1.5">
                                            <i class="ph ph-graduation-cap text-[#cc5500] group-hover:text-white text-sm transition-colors"></i>
                                            <h3 class="font-['Plus_Jakarta_Sans'] font-medium text-xs text-[#8B4513] group-hover:text-white transition-colors whitespace-nowrap">
                                                Course Evaluation
                                            </h3>
                                        </div>
                                    </div>
                                    
                                    <!-- Hotel Experience -->
                                    <div class="bg-white border border-[#DAB568] rounded-full px-2 md:px-3 py-1.5 md:py-2 hover:bg-[#cc5500] hover:border-[#cc5500] hover:text-white transition-all duration-200 cursor-pointer group" onclick="useTemplate('hotel-experience')">
                                        <div class="flex items-center gap-1.5">
                                            <i class="ph ph-bed text-[#cc5500] group-hover:text-white text-sm transition-colors"></i>
                                            <h3 class="font-['Plus_Jakarta_Sans'] font-medium text-xs text-[#8B4513] group-hover:text-white transition-colors whitespace-nowrap">
                                                Hotel Experience
                                            </h3>
                                        </div>
                                    </div>
                                    
                                    <!-- Restaurant Feedback -->
                                    <div class="bg-white border border-[#DAB568] rounded-full px-2 md:px-3 py-1.5 md:py-2 hover:bg-[#cc5500] hover:border-[#cc5500] hover:text-white transition-all duration-200 cursor-pointer group" onclick="useTemplate('restaurant-feedback')">
                                        <div class="flex items-center gap-1.5">
                                            <i class="ph ph-fork-knife text-[#cc5500] group-hover:text-white text-sm transition-colors"></i>
                                            <h3 class="font-['Plus_Jakarta_Sans'] font-medium text-xs text-[#8B4513] group-hover:text-white transition-colors whitespace-nowrap">
                                                Restaurant Feedback
                                            </h3>
                                        </div>
                                    </div>
                                    
                                    <!-- Support Experience -->
                                    <div class="bg-white border border-[#DAB568] rounded-full px-2 md:px-3 py-1.5 md:py-2 hover:bg-[#cc5500] hover:border-[#cc5500] hover:text-white transition-all duration-200 cursor-pointer group" onclick="useTemplate('support-satisfaction')">
                                        <div class="flex items-center gap-1.5">
                                            <i class="ph ph-headset text-[#cc5500] group-hover:text-white text-sm transition-colors"></i>
                                            <h3 class="font-['Plus_Jakarta_Sans'] font-medium text-xs text-[#8B4513] group-hover:text-white transition-colors whitespace-nowrap">
                                                Support Experience
                                            </h3>
                                        </div>
                                    </div>
                                    
                                    <!-- Website Experience -->
                                    <div class="bg-white border border-[#DAB568] rounded-full px-2 md:px-3 py-1.5 md:py-2 hover:bg-[#cc5500] hover:border-[#cc5500] hover:text-white transition-all duration-200 cursor-pointer group" onclick="useTemplate('website-feedback')">
                                        <div class="flex items-center gap-1.5">
                                            <i class="ph ph-globe text-[#cc5500] group-hover:text-white text-sm transition-colors"></i>
                                            <h3 class="font-['Plus_Jakarta_Sans'] font-medium text-xs text-[#8B4513] group-hover:text-white transition-colors whitespace-nowrap">
                                                Website Experience
                                            </h3>
                                        </div>
                                    </div>
                                    
                                    <!-- App Experience -->
                                    <div class="bg-white border border-[#DAB568] rounded-full px-2 md:px-3 py-1.5 md:py-2 hover:bg-[#cc5500] hover:border-[#cc5500] hover:text-white transition-all duration-200 cursor-pointer group" onclick="useTemplate('app-review')">
                                        <div class="flex items-center gap-1.5">
                                            <i class="ph ph-device-mobile text-[#cc5500] group-hover:text-white text-sm transition-colors"></i>
                                            <h3 class="font-['Plus_Jakarta_Sans'] font-medium text-xs text-[#8B4513] group-hover:text-white transition-colors whitespace-nowrap">
                                                App Experience
                                            </h3>
                                        </div>
                                    </div>
                                    
                                    <!-- Beta Testing -->
                                    <div class="bg-white border border-[#DAB568] rounded-full px-2 md:px-3 py-1.5 md:py-2 hover:bg-[#cc5500] hover:border-[#cc5500] hover:text-white transition-all duration-200 cursor-pointer group" onclick="useTemplate('beta-testing')">
                                        <div class="flex items-center gap-1.5">
                                            <i class="ph ph-test-tube text-[#cc5500] group-hover:text-white text-sm transition-colors"></i>
                                            <h3 class="font-['Plus_Jakarta_Sans'] font-medium text-xs text-[#8B4513] group-hover:text-white transition-colors whitespace-nowrap">
                                                Beta Testing
                                            </h3>
                                        </div>
                                    </div>
                                    
                                    <!-- Market Research -->
                                    <div class="bg-white border border-[#DAB568] rounded-full px-2 md:px-3 py-1.5 md:py-2 hover:bg-[#cc5500] hover:border-[#cc5500] hover:text-white transition-all duration-200 cursor-pointer group" onclick="useTemplate('market-research')">
                                        <div class="flex items-center gap-1.5">
                                            <i class="ph ph-magnifying-glass text-[#cc5500] group-hover:text-white text-sm transition-colors"></i>
                                            <h3 class="font-['Plus_Jakarta_Sans'] font-medium text-xs text-[#8B4513] group-hover:text-white transition-colors whitespace-nowrap">
                                                Market Research
                                            </h3>
                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                            
                        </div>
                    </div>
                    
                    <!-- Dots Indicator -->
                    <div id="carousel-dots" class="flex justify-center gap-1.5 mt-6">
                        <!-- Dots will be generated by JavaScript -->
                    </div>
                </div>
            </div>
            <!-- Features -->
            <div class="text-center max-w-4xl mt-12 md:mt-16">
                <div class="grid grid-cols-2 md:grid-cols-5 gap-4 md:gap-6">
                    <div class="flex flex-col items-center p-4">
                        <div class="w-12 h-12 bg-[#cc5500]/10 rounded-xl flex items-center justify-center mb-3">
                            <i class="ph ph-magic-wand text-[#cc5500] text-xl"></i>
                        </div>
                        <span class="font-['Plus_Jakarta_Sans'] font-medium text-sm text-[#6b7280]">AI-Generated</span>
                    </div>
                    <div class="flex flex-col items-center p-4">
                        <div class="w-12 h-12 bg-[#cc5500]/10 rounded-xl flex items-center justify-center mb-3">
                            <i class="ph ph-chat-circle text-[#cc5500] text-xl"></i>
                        </div>
                        <span class="font-['Plus_Jakarta_Sans'] font-medium text-sm text-[#6b7280]">Chat Interface</span>
                    </div>
                    <div class="flex flex-col items-center p-4">
                        <div class="w-12 h-12 bg-[#cc5500]/10 rounded-xl flex items-center justify-center mb-3">
                            <i class="ph ph-file-csv text-[#cc5500] text-xl"></i>
                        </div>
                        <span class="font-['Plus_Jakarta_Sans'] font-medium text-sm text-[#6b7280]">CSV Export</span>
                    </div>
                    <div class="flex flex-col items-center p-4">
                        <div class="w-12 h-12 bg-[#cc5500]/10 rounded-xl flex items-center justify-center mb-3">
                            <i class="ph ph-share text-[#cc5500] text-xl"></i>
                        </div>
                        <span class="font-['Plus_Jakarta_Sans'] font-medium text-sm text-[#6b7280]">Share Links</span>
                    </div>
                    <div class="flex flex-col items-center p-4">
                        <div class="w-12 h-12 bg-[#cc5500]/10 rounded-xl flex items-center justify-center mb-3">
                            <i class="ph ph-chart-bar text-[#cc5500] text-xl"></i>
                        </div>
                        <span class="font-['Plus_Jakarta_Sans'] font-medium text-sm text-[#6b7280]">Dashboard</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase Configuration -->
    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBk-JxeyA-e-H8lcV-INxZKRgMq3cyXGyQ",
            authDomain: "barmuda-in.firebaseapp.com",
            projectId: "barmuda-in",
            storageBucket: "barmuda-in.firebasestorage.app",
            messagingSenderId: "36564437421",
            appId: "1:36564437421:web:2a16afe9674a9d03333924",
            measurementId: "G-7C7SPTNMLT"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        
        // Initialize Google Analytics
        let analytics = null;
        try {
            if (typeof firebase.analytics === 'function') {
                analytics = firebase.analytics();
                console.log('Google Analytics initialized on create_form page');
                
                // Track page view
                analytics.logEvent('page_view', {
                    page_title: document.title,
                    page_location: window.location.href
                });
            }
        } catch (error) {
            console.warn('Analytics initialization failed:', error);
        }

        // Authentication functions
        async function signOut() {
            try {
                await auth.signOut();
                const response = await fetch('/auth/logout', {
                    method: 'POST',
                    credentials: 'include'
                });
                window.location.href = '/';
            } catch (error) {
                console.error('Sign out error:', error);
                alert('Failed to sign out');
            }
        }

        // Helper function for session-based authenticated requests
        async function authenticatedFetch(url, options = {}) {
            return fetch(url, {
                ...options,
                credentials: 'include',
                headers: {
                    ...options.headers,
                    'Content-Type': 'application/json',
                }
            });
        }

        // Validation state
        let validationTimeout;
        let isValid = false;
        
        // Real-time input validation with debouncing
        function validateInput() {
            const input = document.getElementById('formDump');
            const generateBtn = document.getElementById('generateBtn');
            const validationMessage = document.getElementById('validationMessage');
            const inputCard = document.getElementById('inputCard');
            
            console.log('validateInput called');
            console.log('Elements found:', { input: !!input, generateBtn: !!generateBtn, validationMessage: !!validationMessage, inputCard: !!inputCard });
            
            // Check if all required elements exist
            if (!input || !generateBtn || !validationMessage || !inputCard) {
                console.warn('Some required elements not found in validateInput');
                console.warn('Missing:', { input: !input, generateBtn: !generateBtn, validationMessage: !validationMessage, inputCard: !inputCard });
                return;
            }
            
            clearTimeout(validationTimeout);
            
            validationTimeout = setTimeout(() => {
                const text = input.value.trim();
                const validation = validateFormInput(text);
                
                console.log('Validation result:', { text: text, length: text.length, validation: validation });
                
                if (validation.isValid) {
                    // Valid input
                    isValid = true;
                    generateBtn.disabled = false;
                    console.log('Button enabled!');
                    validationMessage.classList.add('hidden');
                    inputCard.classList.remove('border-red-300');
                    inputCard.classList.add('border-[#fb9a9a]');
                } else {
                    // Invalid input
                    isValid = false;
                    generateBtn.disabled = true;
                    if (validation.message && text.length > 0) {
                        validationMessage.textContent = validation.message;
                        validationMessage.classList.remove('hidden');
                        inputCard.classList.add('border-red-300');
                        inputCard.classList.remove('border-[#fb9a9a]');
                    } else {
                        validationMessage.classList.add('hidden');
                        inputCard.classList.remove('border-red-300');
                        inputCard.classList.add('border-[#fb9a9a]');
                    }
                }
                
                setButtonState('idle');
            }, 300); // 300ms debounce
        }
        
        // Comprehensive input validation
        function validateFormInput(text) {
            // Empty or too short
            if (!text || text.length === 0) {
                return { isValid: false, message: '' };
            }
            
            if (text.length < 20) {
                return { 
                    isValid: false, 
                    message: 'Please provide more details about your form (minimum 20 characters)' 
                };
            }
            
            // Only whitespace or newlines
            if (!/\S/.test(text) || text.replace(/\s/g, '').length < 10) {
                return { 
                    isValid: false, 
                    message: 'Please describe what kind of form you want to create' 
                };
            }
            
            // Repetitive characters (like "aaaaaaa" or "1111111")
            const repetitivePattern = /(.)\1{6,}/;
            if (repetitivePattern.test(text)) {
                return { 
                    isValid: false, 
                    message: 'Please provide a meaningful description of your form' 
                };
            }
            
            // Keyboard mashing detection
            const keyboardMashing = /^[qwertyuiop]+$|^[asdfghjkl]+$|^[zxcvbnm]+$/i;
            if (keyboardMashing.test(text.replace(/\s/g, ''))) {
                return { 
                    isValid: false, 
                    message: 'Please provide a real description of the form you want to create' 
                };
            }
            
            // Not form-related (basic check)
            const formKeywords = /\b(form|survey|question|data|collect|response|feedback|poll|quiz|assessment|evaluation|information|details|input)\b/i;
            const nonFormKeywords = /\b(weather|time|date|news|sports|movie|music|food|recipe|game|joke|story)\b/i;
            
            if (nonFormKeywords.test(text) && !formKeywords.test(text)) {
                return { 
                    isValid: false, 
                    message: 'This doesn\'t seem to be about creating a form. Please describe your form goals.' 
                };
            }
            
            return { isValid: true, message: '' };
        }
        
        // Enhanced loading states
        function setButtonState(state) {
            const generateBtn = document.getElementById('generateBtn');
            const buttonText = document.getElementById('buttonText');
            const buttonSpinner = document.getElementById('buttonSpinner');
            
            if (!generateBtn || !buttonText || !buttonSpinner) return;
            
            switch(state) {
                case 'validating':
                    generateBtn.disabled = true;
                    buttonText.textContent = 'validating...';
                    buttonSpinner.classList.remove('hidden');
                    break;
                case 'generating':
                    buttonText.textContent = 'generating';
                    buttonSpinner.classList.remove('hidden');
                    break;
                case 'redirecting':
                    buttonText.textContent = 'redirecting...';
                    buttonSpinner.classList.remove('hidden');
                    break;
                case 'idle':
                    generateBtn.disabled = !isValid;
                    buttonText.textContent = 'generate form';
                    buttonSpinner.classList.add('hidden');
                    break;
                case 'error':
                    generateBtn.disabled = false;
                    buttonText.textContent = 'try again';
                    buttonSpinner.classList.add('hidden');
                    break;
            }
        }
        
        // Enhanced generate form function with progressive loading
        async function generateForm() {
            const dumpInput = document.getElementById('formDump');
            const errorState = document.getElementById('errorState');
            
            const dump = dumpInput.value.trim();
            
            console.log('Generating form with input:', dump);
            console.log('Input length:', dump.length);
            
            // Final validation before submission
            const validation = validateFormInput(dump);
            console.log('Frontend validation result:', validation);
            
            if (!validation.isValid) {
                showError(validation.message || 'Please provide a valid form description');
                return;
            }
            
            // Progressive loading states
            setButtonState('validating');
            errorState.classList.add('hidden');
            
            try {
                // Small delay for UX
                await new Promise(resolve => setTimeout(resolve, 500));
                
                setButtonState('generating');
                
                // Clear any old form data first
                sessionStorage.removeItem('generatedForm');
                
                console.log('Sending request to /api/infer');
                
                const response = await authenticatedFetch('/api/infer', {
                    method: 'POST',
                    body: JSON.stringify({ dump })
                });
                
                console.log('Response status:', response.status);
                
                const data = await response.json();
                console.log('Backend response:', data);
                
                if (data.success) {
                    setButtonState('redirecting');
                    
                    // Track form creation event
                    if (analytics) {
                        analytics.logEvent('form_created', {
                            form_id: data.form_id || 'temp_form',
                            method: 'ai_generation',
                            questions_count: data.form?.questions?.length || 0
                        });
                    }
                    
                    // Small delay before redirect
                    await new Promise(resolve => setTimeout(resolve, 500));
                    
                    // Redirect to edit form page with form_id
                    if (data.form_id) {
                        window.location.href = `/edit-form?id=${data.form_id}`;
                    } else {
                        // Fallback to sessionStorage if auto-save failed
                        sessionStorage.setItem('generatedForm', JSON.stringify(data.form));
                        window.location.href = '/edit-form';
                    }
                } else {
                    setButtonState('error');
                    showError(data.error || 'Failed to generate form');
                }
                
            } catch (error) {
                console.error('Generate form error:', error);
                setButtonState('error');
                
                if (error.message.includes('401') || error.message.includes('Unauthorized')) {
                    showError('Please sign in to generate forms');
                } else {
                    showError('Network error. Please check your connection and try again.');
                }
            }
        }
        
        // Show error function
        function showError(message) {
            const errorState = document.getElementById('errorState');
            const errorMessage = document.getElementById('errorMessage');
            
            errorMessage.textContent = message;
            errorState.classList.remove('hidden');
        }
        
        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Create form page loaded');
            
            // Clear any old generated form data to prevent cache issues
            sessionStorage.removeItem('generatedForm');
            
            // Initial validation state
            const generateBtn = document.getElementById('generateBtn');
            console.log('Generate button found:', !!generateBtn);
            generateBtn.disabled = true;
            console.log('Generate button disabled initially');
            
            // Check for pending form description from unauthenticated flow
            const pendingDescription = sessionStorage.getItem('pendingFormDescription');
            if (pendingDescription) {
                const formDump = document.getElementById('formDump');
                formDump.value = pendingDescription;
                // Clear from sessionStorage
                sessionStorage.removeItem('pendingFormDescription');
                // Validate the restored content
                validateInput();
                // Focus at end of text
                formDump.focus();
                formDump.setSelectionRange(formDump.value.length, formDump.value.length);
            } else {
                // Initialize validation on any existing content
                validateInput();
            }
            
            console.log('Create form page loaded successfully');
        });
        
        // User Interview Templates - Focused on scaling user research
        const templates = {
            // Core User Research
            'user-interview': `I want to conduct user interviews to understand how people use our product. Help me create questions that explore user goals, pain points, current workflows, feature preferences, and unmet needs. I want to discover what problems our users are trying to solve and how our product fits into their daily routine.`,
            
            'product-discovery': `I need to validate a new product idea through user interviews. Create questions to understand the target market's current solutions, biggest frustrations, willingness to try new approaches, and what success looks like for them. Focus on problem validation and market fit.`,
            
            'customer-journey': `I want to map the customer journey by interviewing users about their entire experience with our product. Create questions covering awareness, consideration, onboarding, daily usage, support interactions, and renewal decisions. Help me identify friction points and optimization opportunities.`,
            
            'pain-point-analysis': `I need to deeply understand user pain points through interviews. Create questions that uncover daily frustrations, workarounds people use, costs of current problems, and emotional impact. Help me prioritize which problems to solve first.`,
            
            // Feature & Product Validation  
            'feature-validation': `I want to validate specific features through user interviews before building them. Create questions about current workflows, desired outcomes, feature priorities, usability concerns, and willingness to adopt. Help me understand if this feature solves real problems.`,
            
            'usability-testing': `I need to conduct usability interviews to improve our product experience. Create questions about task completion, navigation challenges, confusing elements, missing functionality, and overall satisfaction. Focus on identifying UX improvements.`,
            
            'persona-research': `I want to build accurate user personas through interviews. Create questions about demographics, roles, goals, challenges, tools used, decision-making process, and motivations. Help me understand different user segments and their unique needs.`,
            
            'jobs-to-be-done': `I need to understand what job users are hiring our product to do. Create interview questions that explore the progress users are trying to make, situations that trigger usage, desired outcomes, and alternatives they consider. Focus on the functional and emotional jobs.`,
            
            // Market & Competitive Research
            'product-market-fit': `I want to assess product-market fit through user interviews. Create questions about value perception, recommendation likelihood, usage frequency, switching costs, and what would happen if the product disappeared. Help me measure market pull.`,
            
            'competitor-analysis': `I need to understand how users view competitors through interviews. Create questions about alternative solutions, switching reasons, feature comparisons, pricing sensitivity, and competitive advantages. Help me identify differentiation opportunities.`,
            
            'pricing-validation': `I want to validate pricing through user interviews. Create questions about value perception, budget allocation, price sensitivity, payment preferences, and purchasing decision factors. Help me understand willingness to pay and optimal pricing strategy.`,
            
            'market-segmentation': `I need to identify market segments through user interviews. Create questions about use cases, company size, industry, role, budget, priorities, and buying process. Help me understand different user groups and their distinct needs.`,
            
            // Customer Success & Retention
            'onboarding-research': `I want to improve onboarding through user interviews. Create questions about first impressions, setup challenges, learning curve, time-to-value, and early success metrics. Focus on reducing friction and increasing activation.`,
            
            'churn-prevention': `I need to understand why users churn through exit interviews. Create questions about dissatisfaction drivers, unmet needs, competitor advantages, pricing concerns, and what could have prevented churn. Help me reduce customer losses.`,
            
            'expansion-research': `I want to identify upsell opportunities through user interviews. Create questions about growing needs, budget increases, additional use cases, team expansion, and feature gaps. Help me understand expansion potential.`,
            
            'nps-deep-dive': `I need to understand NPS scores through follow-up interviews. Create questions for promoters, passives, and detractors about their experience, specific feedback, improvement suggestions, and referral likelihood. Turn scores into actionable insights.`,
            
            // Strategic Research
            'roadmap-prioritization': `I want to inform product roadmap through user interviews. Create questions about current frustrations, desired capabilities, workflow inefficiencies, and future needs. Help me prioritize features that matter most to users.`,
            
            'brand-perception': `I need to understand brand perception through user interviews. Create questions about brand awareness, associations, trust levels, competitive positioning, and emotional connection. Help me strengthen brand strategy.`,
            
            'user-behavior': `I want to understand user behavior patterns through interviews. Create questions about usage frequency, feature adoption, workflow integration, collaboration patterns, and behavior triggers. Help me optimize for actual usage patterns.`,
            
            'retention-drivers': `I need to identify what keeps users engaged through interviews. Create questions about value realization, habit formation, switching costs, satisfaction drivers, and loyalty factors. Help me increase long-term retention.`,
            
            // Specialized Research
            'b2b-buying-process': `I want to understand B2B buying decisions through stakeholder interviews. Create questions about decision criteria, buying committee, evaluation process, implementation concerns, and approval requirements. Help me optimize sales processes.`,
            
            'mobile-usage': `I need to understand mobile usage patterns through user interviews. Create questions about mobile context, device preferences, app usage, cross-platform workflows, and mobile-specific needs. Help me optimize mobile experiences.`,
            
            'integration-research': `I want to understand integration needs through user interviews. Create questions about current tool stack, workflow connections, data sharing, automation desires, and integration priorities. Help me build valuable integrations.`,
            
            'accessibility-research': `I need to understand accessibility needs through user interviews. Create questions about assistive technologies, navigation challenges, content preferences, interaction difficulties, and inclusive design needs. Help me build accessible products.`,
            
            // Additional specialized templates
            'customer-feedback': `I want to collect comprehensive customer feedback through interviews. Create questions about overall satisfaction, specific feature experiences, service quality, improvement suggestions, and loyalty factors. Help me understand customer sentiment.`,
            
            'employee-survey': `I need to conduct employee experience interviews. Create questions about job satisfaction, company culture, growth opportunities, management effectiveness, work-life balance, and workplace improvements. Help me understand employee engagement.`,
            
            'app-review': `I want to gather user feedback about our mobile app through interviews. Create questions about user interface, performance, features, navigation, bugs, and desired improvements. Help me optimize the app experience.`,
            
            'market-research': `I need to conduct market research through user interviews. Create questions about industry trends, competitive landscape, customer preferences, emerging needs, and market opportunities. Help me understand market dynamics.`
        };

        // Use template function
        function useTemplate(templateId) {
            const template = templates[templateId];
            if (template) {
                const formDump = document.getElementById('formDump');
                if (!formDump) {
                    console.warn('formDump element not found');
                    return;
                }
                formDump.value = template;
                
                // Trigger validation
                validateInput();
                
                // Focus and scroll to textarea
                formDump.focus();
                formDump.scrollIntoView({ behavior: 'smooth', block: 'center' });
                
                // Set cursor to end of text
                formDump.setSelectionRange(formDump.value.length, formDump.value.length);
            }
        }

        // Initialize event listeners after DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            // Allow Ctrl/Cmd+Enter to trigger form generation
            const formDumpElement = document.getElementById('formDump');
            if (formDumpElement) {
                formDumpElement.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter' && (e.ctrlKey || e.metaKey)) {
                        e.preventDefault();
                        if (isValid) {
                            generateForm();
                        }
                    }
                });
            }
            
            // Handle button state reset on error dismissal
            document.addEventListener('click', function(e) {
                if (e.target.textContent === 'Dismiss' && e.target.closest('#errorState')) {
                    setTimeout(() => {
                        setButtonState('idle');
                    }, 100);
                }
            });
        });
        
        // Page-based Carousel functionality
        let currentPage = 0;
        let totalPages = 3; // We have 3 pages of templates
        
        function initializeCarousel() {
            const track = document.getElementById('carousel-track');
            const dotsContainer = document.getElementById('carousel-dots');
            
            if (!track) return;
            
            // Update carousel position
            function updateCarousel() {
                const translateX = -(currentPage * 100);
                track.style.transform = `translateX(${translateX}%)`;
            }
            
            // Update dots indicator
            function updateDots() {
                dotsContainer.innerHTML = '';
                
                for (let i = 0; i < totalPages; i++) {
                    const dot = document.createElement('button');
                    dot.className = `w-2 h-2 rounded-full transition-all duration-300 ${
                        i === currentPage 
                            ? 'bg-[#cc5500] scale-125' 
                            : 'bg-[#DAB568] hover:bg-[#cc5500]/60 hover:scale-110'
                    }`;
                    dot.onclick = () => goToPage(i);
                    dotsContainer.appendChild(dot);
                }
            }
            
            // Go to specific page
            function goToPage(pageIndex) {
                if (pageIndex >= 0 && pageIndex < totalPages) {
                    currentPage = pageIndex;
                    updateCarousel();
                    updateDots();
                }
            }
            
            // Touch/swipe support
            let startX = 0;
            let isDragging = false;
            
            track.addEventListener('touchstart', (e) => {
                startX = e.touches[0].clientX;
                isDragging = true;
            }, { passive: true });
            
            track.addEventListener('touchmove', (e) => {
                if (!isDragging) return;
                e.preventDefault();
            }, { passive: false });
            
            track.addEventListener('touchend', (e) => {
                if (!isDragging) return;
                
                const endX = e.changedTouches[0].clientX;
                const diff = startX - endX;
                const threshold = 50; // minimum swipe distance
                
                if (Math.abs(diff) > threshold) {
                    if (diff > 0 && currentPage < totalPages - 1) {
                        // Swipe left - next page
                        goToPage(currentPage + 1);
                    } else if (diff < 0 && currentPage > 0) {
                        // Swipe right - previous page
                        goToPage(currentPage - 1);
                    }
                }
                
                isDragging = false;
            }, { passive: true });
            
            // Keyboard support
            document.addEventListener('keydown', (e) => {
                if (e.target.tagName.toLowerCase() === 'input' || e.target.tagName.toLowerCase() === 'textarea') {
                    return; // Don't interfere with form inputs
                }
                
                if (e.key === 'ArrowLeft' && currentPage > 0) {
                    goToPage(currentPage - 1);
                } else if (e.key === 'ArrowRight' && currentPage < totalPages - 1) {
                    goToPage(currentPage + 1);
                }
            });
            
            // Initialize dots
            updateDots();
        }
        
        // Initialize carousel on page load
        document.addEventListener('DOMContentLoaded', function() {
            initializeCarousel();
        });
    </script>

    {% include 'partials/footer.html' %}
</body>
</html>